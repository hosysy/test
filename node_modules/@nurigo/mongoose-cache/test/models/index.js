'use strict'

const mongoose = require('mongoose')
const mongooseCache = require('../../lib')
const Schema = mongoose.Schema

mongooseCache(mongoose, [
  {
    name: 'Record',
    key: [
      'num'
    ]
  }
], __dirname, { ttl: 5 })

const RecordSchema = new Schema({
  num: Number,
  str: String,
  date: {
    type: Date,
    default: Date.now
  }
})

RecordSchema.pre('save', function (next) {
  this._id = this.num
  next()
})

module.exports.Record  = mongoose.model('Record', RecordSchema)
