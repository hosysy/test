/**
 * @author Henry Kim <henry@nurigo.net>
 */
'use strict'

const mongoose = require('mongoose')

module.exports = {
  /**
   * require('@nurigo/mongo').init({ host: 'localhost', database: 'test' }) 와 같은 형식을 통해 몽고디비를 연결합니다.
   *
   * @param {object} param - mongodb 에 연결될 정보들 입니다.
   */
  async init ({ host, database, options = {
    autoReconnect: true,
    reconnectTries: 10,
    reconnectInterval: 100
  }}) {
    if (!host || !database) throw new Error(`MongoDB connection error, 유효하지 않은 DB 접속정보`)
    await mongoose.connect(`mongodb://${host}/${database}`, options)
  },
  mongoose
}
